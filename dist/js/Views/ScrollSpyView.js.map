{"version":3,"sources":["../../../src/js/Views/ScrollSpyView.js"],"names":["ScrollSpyView","initialize","queue","constructor","name","TypeError","render","force","rendered","$container","parent","$el","$","window","inside","on","cid","e","each","idx","obj","$this","subview","data","isInView","trigger","subViewInstances","el","winH","innerHeight","scrollTop","document","documentElement","body","scrollBottom","rect","getBoundingClientRect","elTop","top","elBottom","offsetHeight"],"mappings":";;;;AAAA;;;;AACA;;;;;;;;;;IAEqBA,a;;;;;;;;;yBAEpBC,U,yBAAa;AACZ,uBAAMA,UAAN;AACA,OAAKC,KAAL,GAAa,EAAb;AACA,MAAK,KAAKC,WAAL,CAAiBC,IAAjB,KAA0B,eAA/B,EAAiD;AAChD,SAAM,IAAIC,SAAJ,CAAe,mDAAf,CAAN;AACA;AACD,E;;yBAEDC,M,mBAAQC,K,EAAQ;AAAA;;AACf,MAAIC,WAAW,KAAKA,QAApB;AACA,uBAAMF,MAAN,YAAcC,KAAd;;AAEA,MAAK,CAACC,QAAD,IAAaD,KAAlB,EAA0B;;AAEzB,OAAIE,aACH,KAAKC,MADW,GAEb,KAAKA,MAAL,CAAYC,GAFC,GAEKC,EAAGC,MAAH,CAFtB;AAGA,OAAIC,SAAS,EAAb;;AAEAL,cAAWM,EAAX,CAAe,YAAY,KAAKC,GAAhC,EAAqC,0BAAU,UAAEC,CAAF,EAAS;AACvDL,MAAG,gBAAH,EAAqB,OAAKD,GAA1B,EAAgCO,IAAhC,CAAsC,UAAEC,GAAF,EAAOC,GAAP,EAAgB;AACrD,SAAIC,QAAQT,EAAGQ,GAAH,CAAZ;AAAA,SAAsBE,UAAUD,MAAME,IAAN,CAAY,SAAZ,CAAhC;;AAEA;AACA,SAAK,OAAKC,QAAL,CAAeJ,GAAf,CAAL,EAA4B;AAC3B;AACA,UAAK,CAACN,OAAQQ,OAAR,CAAN,EAA0B;AACzBR,cAAQQ,OAAR,IAAoB,IAApB;;AAEA;AACA,cAAKG,OAAL,CAAc,aAAd,EAA6B;AAC5BH,iBAASA;AADmB,QAA7B;;AAIA,WAAK,OAAKI,gBAAL,CAAuBJ,OAAvB,CAAL,EAAwC;AACvC,eAAKI,gBAAL,CAAuBJ,OAAvB,EAAiCG,OAAjC,CAA0C,aAA1C;AACA;AAED;;AAED;AACA,aAAKA,OAAL,CAAc,YAAd,EAA4B;AAC3BX,eAAQA,OAAQQ,OAAR;AADmB,OAA5B;AAGA,MApBD,MAoBO;;AAEN,UAAKR,OAAQQ,OAAR,CAAL,EAAyB;AACxBR,cAAQQ,OAAR,IAAoB,KAApB;AACA;AACA,cAAKG,OAAL,CAAc,aAAd,EAA6B;AAC5BH,iBAASA;AADmB,QAA7B;;AAIA,WAAK,OAAKI,gBAAL,CAAuBJ,OAAvB,CAAL,EAAwC;AACvC,eAAKI,gBAAL,CAAuBJ,OAAvB,EAAiCG,OAAjC,CAA0C,aAA1C;AACA;AAED;AACD;AACD,KAvCD;AAyCA,IA1CoC,EA0ClC,GA1CkC,CAArC;AA4CA;AAED,E;;yBAEDD,Q,qBAAUG,E,EAAK;AACd,MAAIC,OAAOf,OAAOgB,WAAlB;AAAA,MACCC,YAAYC,SAASC,eAAT,CAAyBF,SAAzB,IAAsCC,SAASE,IAAT,CAAcH,SADjE;AAAA,MAECI,eAAeJ,YAAYF,IAF5B;AAAA,MAGCO,OAAOR,GAAGS,qBAAH,EAHR;AAAA,MAICC,QAAQF,KAAKG,GAAL,GAAWR,SAJpB;AAAA,MAKCS,WAAWF,QAAQV,GAAGa,YALvB;AAMA,MAAKH,UAAUE,QAAV,IAAsBA,aAAaL,YAAxC,EAAuD;AACtD;AACA,UAAO,IAAP;AAEA;AACD,SACCG,QAAQH,YADF,IAGNK,YAAYT,SAHb;AAKA,E;;;;;kBAtFmB9B,a","file":"ScrollSpyView.js","sourcesContent":["import BiontView from \"./BiontView\";\nimport {throttle} from \"underscore\";\n\nexport default class ScrollSpyView extends BiontView {\n\n\tinitialize() {\n\t\tsuper.initialize();\n\t\tthis.queue = {};\n\t\tif ( this.constructor.name === 'ScrollSpyView' ) {\n\t\t\tthrow new TypeError( \"Cannot construct ScrollSpyView instances directly\" );\n\t\t}\n\t}\n\n\trender( force ) {\n\t\tlet rendered = this.rendered;\n\t\tsuper.render( force );\n\n\t\tif ( !rendered || force ) {\n\n\t\t\tlet $container = (\n\t\t\t\tthis.parent\n\t\t\t) ? this.parent.$el : $( window );\n\t\t\tlet inside = {};\n\n\t\t\t$container.on( 'scroll.' + this.cid, throttle( ( e ) => {\n\t\t\t\t$( '[data-subview]', this.$el ).each( ( idx, obj ) => {\n\t\t\t\t\tlet $this = $( obj ), subview = $this.data( 'subview' );\n\n\t\t\t\t\t/* if we have reached the minimum bound but are below the max ... */\n\t\t\t\t\tif ( this.isInView( obj ) ) {\n\t\t\t\t\t\t/* trigger enter event */\n\t\t\t\t\t\tif ( !inside[ subview ] ) {\n\t\t\t\t\t\t\tinside[ subview ] = true;\n\n\t\t\t\t\t\t\t/* fire enter event */\n\t\t\t\t\t\t\tthis.trigger( 'scrollEnter', {\n\t\t\t\t\t\t\t\tsubview: subview\n\t\t\t\t\t\t\t} );\n\n\t\t\t\t\t\t\tif ( this.subViewInstances[ subview ] ) {\n\t\t\t\t\t\t\t\tthis.subViewInstances[ subview ].trigger( 'scrollEnter' );\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t/* trigger tick event */\n\t\t\t\t\t\tthis.trigger( 'scrollTick', {\n\t\t\t\t\t\t\tinside: inside[ subview ],\n\t\t\t\t\t\t} );\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tif ( inside[ subview ] ) {\n\t\t\t\t\t\t\tinside[ subview ] = false;\n\t\t\t\t\t\t\t/* trigger leave event */\n\t\t\t\t\t\t\tthis.trigger( 'scrollLeave', {\n\t\t\t\t\t\t\t\tsubview: subview\n\t\t\t\t\t\t\t} );\n\n\t\t\t\t\t\t\tif ( this.subViewInstances[ subview ] ) {\n\t\t\t\t\t\t\t\tthis.subViewInstances[ subview ].trigger( 'scrollLeave' );\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} );\n\n\t\t\t}, 100 ) );\n\n\t\t}\n\n\t}\n\n\tisInView( el ) {\n\t\tlet winH = window.innerHeight,\n\t\t\tscrollTop = document.documentElement.scrollTop || document.body.scrollTop,\n\t\t\tscrollBottom = scrollTop + winH,\n\t\t\trect = el.getBoundingClientRect(),\n\t\t\telTop = rect.top + scrollTop,\n\t\t\telBottom = elTop + el.offsetHeight;\n\t\tif ( elTop === elBottom && elBottom === scrollBottom ) {\n\t\t\t// Element has 0 height and we're scrolled right to the bottom\n\t\t\treturn true;\n\n\t\t}\n\t\treturn (\n\t\t\telTop < scrollBottom\n\t\t\t) && (\n\t\t\telBottom >= scrollTop\n\t\t\t);\n\t};\n\n}"]}