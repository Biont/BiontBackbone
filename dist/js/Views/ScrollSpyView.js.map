{"version":3,"sources":["../../../src/js/Views/ScrollSpyView.js"],"names":["ScrollSpyView","initialize","queue","constructor","name","TypeError","render","force","rendered","$container","parent","$el","$","window","inside","on","cid","e","each","idx","obj","$this","subview","data","isInView","trigger","el","winH","innerHeight","scrollTop","document","documentElement","body","scrollBottom","rect","getBoundingClientRect","elTop","top","elBottom","offsetHeight"],"mappings":";;;;AACA;;;;AACA;;;;;;;;;;IAGqBA,a;;;;;;;;;yBAEpBC,U,yBAAa;AACZ,uBAAMA,UAAN;AACA,OAAKC,KAAL,GAAa,EAAb;AACA,MAAI,KAAKC,WAAL,CAAiBC,IAAjB,KAA0B,eAA9B,EAA+C;AAC9C,SAAM,IAAIC,SAAJ,CAAc,mDAAd,CAAN;AACA;AACD,E;;yBAEDC,M,mBAAOC,K,EAAO;AAAA;;AACb,MAAIC,WAAW,KAAKA,QAApB;AACA,uBAAMF,MAAN,YAAaC,KAAb;;AAEA,MAAI,CAACC,QAAD,IAAaD,KAAjB,EAAwB;;AAEvB,OAAIE,aAAc,KAAKC,MAAN,GAAgB,KAAKA,MAAL,CAAYC,GAA5B,GAAkCC,EAAEC,MAAF,CAAnD;AACA,OAAIC,SAAS,EAAb;;AAEAL,cAAWM,EAAX,CAAc,YAAY,KAAKC,GAA/B,EAAoC,0BAAS,UAACC,CAAD,EAAO;AACnDL,MAAE,gBAAF,EAAoB,OAAKD,GAAzB,EAA8BO,IAA9B,CAAmC,UAACC,GAAD,EAAMC,GAAN,EAAc;AAChD,SAAIC,QAAQT,EAAEQ,GAAF,CAAZ;AAAA,SAAoBE,UAAUD,MAAME,IAAN,CAAW,SAAX,CAA9B;;AAEA;AACA,SAAI,OAAKC,QAAL,CAAcJ,GAAd,CAAJ,EAAwB;AACvB;AACA,UAAI,CAACN,OAAOQ,OAAP,CAAL,EAAsB;AACrBR,cAAOQ,OAAP,IAAkB,IAAlB;;AAEA;AACA,cAAKX,GAAL,CAASc,OAAT,CAAiB,aAAjB,EAAgC;AAC/BH,iBAASD,MAAME,IAAN,CAAW,SAAX;AADsB,QAAhC;AAIA;;AAED;AACA,aAAKZ,GAAL,CAASc,OAAT,CAAiB,YAAjB,EAA+B;AAC9BX,eAAQA,OAAOQ,OAAP;AADsB,OAA/B;AAGA,MAhBD,MAgBO;;AAEN,UAAIR,OAAOQ,OAAP,CAAJ,EAAqB;AACpBR,cAAOQ,OAAP,IAAkB,KAAlB;AACA;AACA,cAAKX,GAAL,CAASc,OAAT,CAAiB,aAAjB,EAAgC;AAC/BH,iBAASD,MAAME,IAAN,CAAW,SAAX;AADsB,QAAhC;AAGA;AACD;AACD,KA9BD;AAgCA,IAjCmC,EAiCjC,GAjCiC,CAApC;AAmCA;AAGD,E;;yBAEDC,Q,qBAASE,E,EAAI;AACZ,MAAIC,OAAOd,OAAOe,WAAlB;AAAA,MACCC,YAAYC,SAASC,eAAT,CAAyBF,SAAzB,IAAsCC,SAASE,IAAT,CAAcH,SADjE;AAAA,MAECI,eAAeJ,YAAYF,IAF5B;AAAA,MAGCO,OAAOR,GAAGS,qBAAH,EAHR;AAAA,MAICC,QAAQF,KAAKG,GAAL,GAAWR,SAJpB;AAAA,MAKCS,WAAWF,QAAQV,GAAGa,YALvB;AAMA;AACA;AACA;AACA;AACA,MAAIH,UAAUE,QAAV,IAAsBA,aAAaL,YAAvC,EAAqD;AACpD;AACA,UAAO,IAAP;AAEA;AACD,SAAQG,QAAQH,YAAT,IAA2BK,YAAYT,SAA9C;AACA,E;;;;;kBA5EmB7B,a","file":"ScrollSpyView.js","sourcesContent":["\nimport BiontView from './BiontView';\nimport {throttle}from'underscore';\n\n\nexport default class ScrollSpyView extends BiontView {\n\n\tinitialize() {\n\t\tsuper.initialize();\n\t\tthis.queue = {};\n\t\tif (this.constructor.name === 'ScrollSpyView') {\n\t\t\tthrow new TypeError(\"Cannot construct ScrollSpyView instances directly\");\n\t\t}\n\t}\n\n\trender(force) {\n\t\tlet rendered = this.rendered;\n\t\tsuper.render(force);\n\n\t\tif (!rendered || force) {\n\n\t\t\tlet $container = (this.parent) ? this.parent.$el : $(window);\n\t\t\tlet inside = {};\n\n\t\t\t$container.on('scroll.' + this.cid, throttle((e) => {\n\t\t\t\t$('[data-subview]', this.$el).each((idx, obj) => {\n\t\t\t\t\tlet $this = $(obj), subview = $this.data('subview');\n\n\t\t\t\t\t/* if we have reached the minimum bound but are below the max ... */\n\t\t\t\t\tif (this.isInView(obj)) {\n\t\t\t\t\t\t/* trigger enter event */\n\t\t\t\t\t\tif (!inside[subview]) {\n\t\t\t\t\t\t\tinside[subview] = true;\n\n\t\t\t\t\t\t\t/* fire enter event */\n\t\t\t\t\t\t\tthis.$el.trigger('scrollEnter', {\n\t\t\t\t\t\t\t\tsubview: $this.data('subview')\n\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t/* trigger tick event */\n\t\t\t\t\t\tthis.$el.trigger('scrollTick', {\n\t\t\t\t\t\t\tinside: inside[subview],\n\t\t\t\t\t\t});\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tif (inside[subview]) {\n\t\t\t\t\t\t\tinside[subview] = false;\n\t\t\t\t\t\t\t/* trigger leave event */\n\t\t\t\t\t\t\tthis.$el.trigger('scrollLeave', {\n\t\t\t\t\t\t\t\tsubview: $this.data('subview')\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t}, 100));\n\n\t\t}\n\n\n\t}\n\n\tisInView(el) {\n\t\tlet winH = window.innerHeight,\n\t\t\tscrollTop = document.documentElement.scrollTop || document.body.scrollTop,\n\t\t\tscrollBottom = scrollTop + winH,\n\t\t\trect = el.getBoundingClientRect(),\n\t\t\telTop = rect.top + scrollTop,\n\t\t\telBottom = elTop + el.offsetHeight;\n\t\t// console.log('elTop', elTop)\n\t\t// console.log('elBottom', elBottom)\n\t\t// console.log('scrollBottom', scrollBottom)\n\t\t// console.log('scrollTop', scrollTop)\n\t\tif (elTop === elBottom && elBottom === scrollBottom) {\n\t\t\t// Element has 0 height and we're scrolled right to the bottom\n\t\t\treturn true;\n\n\t\t}\n\t\treturn (elTop < scrollBottom) && (elBottom >= scrollTop);\n\t};\n\n\n\n\n}"]}